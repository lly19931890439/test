<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="../static/css/header.css">
    <link rel="stylesheet" type="text/css" href="../static/css/content.css">
    <link rel="stylesheet" type="text/css" href="../static/css/footer.css">
    <link rel="stylesheet" type="text/css" href="../static/css/font-awesome.css">
    <link rel="stylesheet" type="text/css" href="../static/css/gc.spread.sheets.excel2013white.14.2.2.css" type="text/css">
	<link rel="stylesheet" type="text/css" href="../static/css/spread-table.css">
	<link rel="stylesheet" type="text/css" href="../static/css/global.css">

    <script src="../static/js/jquery_3.1.1.min.js" type="text/javascript"></script>
    <script src="../static/js/gc.spread.sheets.all.11.0.0.min.js" type="text/javascript"></script>
    <script src="../static/js/gc.spread.excelio.11.0.0.min.js" type="text/javascript"></script>
    <script src="../static/js/gc.spread.sheets.resources.zh.11.0.0.min.js" type="text/javascript"></script>
    <script src="../static/js/gc.spread.sheets.print.11.0.0.min.js" type="text/javascript"></script>
    <script src="../static/js/gc.spread.sheets.charts.11.0.0.min.js" type="text/javascript"></script>
    <script src="../static/js/FileSaver.min.js" type="text/javascript"></script>
    <script src="../static/js/v14.js" type="text/javascript"></script>

    <title>数据处理</title>
    <style></style>
	
</head>
<body>
{#    导航栏#}
    <div class="header">
        <ul class="nav">
            <li class="drop-down">
                <a id="fission">fission</a>
            </li>
            <li class="drop-down">
                <a id="radial">radial plot</a>
                <ul class="drop-down-content">
                    <li><a id="ked">KDE</a></li>
                    <li><a id="get">get ζ</a></li>
                    <li><a id="ages">ages</a></li>
                </ul>
            </li>
            <li class="drop-down">
                <a href="#">option</a>
                <ul class="drop-down-content">
{#                    <li><a href="#">选项1</a></li>#}
{#                    <li><a href="#">选项2</a></li>#}
{#                    <li><a href="#">选项3</a></li>#}
                </ul>
            </li>
            <li><a href="#">help</a></li>
        </ul>
    </div>
{#中间数据处理#}
    <div class="content">
{#        中间左边原数据#}
        <div class="left">
            <div class="left-top" id="left-top">
{#               参数1#}
                <div class="center" id="zetaDiv" style="display: block;">
                    ζ:<input type="text" id="zetaVal" Value="350">
                    <span>±</span>
                    <span style="display: none;">, err[ζ]:</span>
                    <input type="text" id="zetaErr" Value="10">
                    <span>
                        <span>
                            yr cm<sup>2</sup>
                        </span>
                        <span style="display: none;">
                            Myr μm<sup>2</sup>
                        </span>
                    </span>
                    <span style="display: none;">%</span>
                    <div style="line-height:50%;"><br></div>
                </div>
{#               参数2#}
                <div class="center" id="standAgeDiv" style="display: none;">
                    t: <input type="text" id="standAgeVal" Value="100">
                    <span>±</span>
                    <span style="display: none;">, err[t]:</span>
                    <input type="text" id="standAgeErr" Value="1">
                    <span>Ma</span>
                    <span style="display: none;">%</span>
                    <div style="line-height:50%;"><br></div>
                </div>
{#               参数3#}
                <div class="center" id="rhoDdiv" style="display: block;">
                    ρ<sub>D</sub>:
                    <input type="text" id="rhoDval" Value="2500000">
                    <span>±</span>
                    <span style="display: none;">, err[ρ<sub>D</sub>]:</span>
                    <input type="text" id="rhoDerr" Value="10000">
                    <span>1/cm<sup>2</sup></span>
                    <span style="display: none;">%</span>
                    <div style="line-height:50%;"><br></div>
                </div>
            </div>
            <div class="left-bottom" id="left-bottom">
                <div id="ss" class="sample-spreadsheets"></div>
            </div>
        </div>
{#        中间右边结果显示#}
        <div class="right">
            <div id="output" class="result"></div>
        </div>
    </div>
{#底部功能栏#}
    <div class="footer">
        <ul class="nav">
            <li><a id="reset">default</a></li>
            <li><a id="clear">clear</a></li>
            <li><a href="#" class="a-upload"><input type="file" id="fileDemo">open</a></li>
            <li><a href="#" id="saveExcel">saveCSV</a></li>
            <li><a id="run">Run</a></li>
            <li><a id="plot">Plot</a></li>
        </ul>
    </div>
    <script src="../static/js/spread-table.js" type="text/javascript"></script>
    <script type="text/javascript">
		function cal(){
			const xhttp = new XMLHttpRequest();	
			var data_table=JSON.parse(JSON.stringify(spread.toJSON())).sheets.Sheet1.data.dataTable;
			xhttp.onload = function(){
				var testJson = JSON.stringify(spread.toJSON());
				const obj = JSON.parse(this.responseText) ;  
            }
			xhttp.open("POST", "caltao");
            xhttp.setRequestHeader("Content-Type", "application/json");
            xhttp.send(JSON.stringify(spread.toJSON()));
			console.log(data_table);
		}
		document.getElementById('run').onclick = cal;
		
		
		function calculate() {
            const xhttp = new XMLHttpRequest();
            var data={
                'zetaVal': document.getElementById('zetaVal').value,
                'zetaErr': document.getElementById('zetaErr').value,
				'standAgeVal': document.getElementById('standAgeVal').value,
				'standAgeErr': document.getElementById('standAgeErr').value,
				'rhoDval': document.getElementById('rhoDval').value,
				'rhoDerr': document.getElementById('rhoDerr').value,
            }
            xhttp.onload = function(){
                const obj = JSON.parse(this.responseText) ;
                console.log( obj );
                //document.getElementById('tao').value = obj['zetaVal'] + obj['zetaErr'];
            }
            xhttp.open("POST", "caltao");
            xhttp.setRequestHeader("Content-Type", "application/json");
            xhttp.send(JSON.stringify(data));
        }
      
        //document.getElementById('run').onclick = calculate;
		
		
		
        function addElementImg(obj) {
            {#获取div元素#}
            var div = document.getElementById(obj);
            {#创建img元素#}
            var img = document.createElement("img");
            {#为img元素设置属性#}
            img.setAttribute("id", "radialImg");
            img.src = "../static/img/plot.png";
            {#将新建的img元素加到div当中#}
            div.appendChild(img);
        }
        $(document).ready(function() {
            {#设置参数#}
            $("#radial").click(function () {
                $("#zetaDiv").css('display', 'block');
                $("#standAgeDiv").css('display', 'none');
            });
            $("#ked").click(function () {
                $("#zetaDiv").css('display', 'block');
                $("#standAgeDiv").css('display', 'none');
            });
            $("#get").click(function () {
                $("#zetaDiv").css('display', 'none');
                $("#standAgeDiv").css('display', 'block');
            });
            $("#ages").click(function () {
                $("#zetaDiv").css('display', 'block');
                $("#standAgeDiv").css('display', 'none');
            });
            {#重新设置按钮-default#}
            $("#reset").click(function () {
                $("#zetaVal").val("350");
                $("#zetaErr").val("10");
                $("#standAgeVal").val("100");
                $("#standAgeErr").val("1");
                $("#rhoDval").val("2500000");
                $("#rhoDerr").val("10000");
            });
            {#清空数据按钮-clear#}
            $('#clear').click(function () {
                sheet.clear(0, 0, sheet.getRowCount(), sheet.getColumnCount(), GC.Spread.Sheets.SheetArea.viewport, GC.Spread.Sheets.StorageType.data);
            });
            $('#plot').click(function () {
                addElementImg("output");
            });
        });
    </script>
</body>
</html>